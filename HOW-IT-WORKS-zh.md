# è‡ªå‹•éƒ¨ç½²ç³»çµ±é‹ä½œåŸç† (ä¸­æ–‡èªªæ˜)

é€™ä»½æ–‡ä»¶è©³ç´°è§£é‡‹ Dockerã€GitHub Actions å’Œè‡ªå‹•éƒ¨ç½²å¦‚ä½•å”åŒé‹ä½œã€‚

---

## ğŸ“š ç›®éŒ„

1. [æ•´é«”æ¶æ§‹åœ–](#æ•´é«”æ¶æ§‹åœ–)
2. [Docker æ˜¯ä»€éº¼ï¼Ÿ](#docker-æ˜¯ä»€éº¼)
3. [GitHub Actions æ˜¯ä»€éº¼ï¼Ÿ](#github-actions-æ˜¯ä»€éº¼)
4. [å®Œæ•´éƒ¨ç½²æµç¨‹](#å®Œæ•´éƒ¨ç½²æµç¨‹)
5. [å„å€‹æª”æ¡ˆçš„ä½œç”¨](#å„å€‹æª”æ¡ˆçš„ä½œç”¨)
6. [è©³ç´°æ­¥é©Ÿè§£æ](#è©³ç´°æ­¥é©Ÿè§£æ)

---

## ğŸ—ï¸ æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å®Œæ•´è‡ªå‹•éƒ¨ç½²æµç¨‹                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç¬¬ä¸€æ­¥ï¼šé–‹ç™¼è€…æ¨é€ä»£ç¢¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ä½ çš„é›»è…¦     â”‚
â”‚             â”‚
â”‚  å¯«å®Œä»£ç¢¼    â”‚â”€â”€git pushâ”€â”€â–¶ GitHub Repository
â”‚             â”‚              (main åˆ†æ”¯)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â†“ è§¸ç™¼

ç¬¬äºŒæ­¥ï¼šGitHub Actions è‡ªå‹•åŸ·è¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         GitHub Actions (é›²ç«¯é‹è¡Œ)           â”‚
â”‚                                            â”‚
â”‚  Step 1: ä¸‹è¼‰ä½ çš„ä»£ç¢¼                       â”‚
â”‚  Step 2: è¨­å®š Docker å»ºç½®å·¥å…·               â”‚
â”‚  Step 3: ç™»å…¥ Docker Hub                   â”‚
â”‚  Step 4: ç”¢ç”Ÿ Docker æ¨™ç±¤                  â”‚
â”‚  Step 5: å»ºç½® Docker æ˜ åƒæª”ä¸¦æ¨é€           â”‚
â”‚         â””â”€â–¶ æ¨é€åˆ° Docker Hub               â”‚
â”‚  Step 6: SSH é€£ç·šåˆ°ä½ çš„ EC2                â”‚
â”‚         â””â”€â–¶ åŸ·è¡Œéƒ¨ç½²æŒ‡ä»¤                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â†“

ç¬¬ä¸‰æ­¥ï¼šDocker Hub å­˜å„²æ˜ åƒæª”
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           Docker Hub (æ˜ åƒå€‰åº«)             â”‚
â”‚                                            â”‚
â”‚  ğŸ“¦ your-username/todo-app:latest          â”‚
â”‚  ğŸ“¦ your-username/todo-app:main-abc123     â”‚
â”‚                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â†“

ç¬¬å››æ­¥ï¼šEC2 æ‹‰å–ä¸¦é‹è¡Œ
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         ä½ çš„ EC2/VPS ä¼ºæœå™¨                 â”‚
â”‚                                            â”‚
â”‚  1. å¾ Docker Hub æ‹‰å–æœ€æ–°æ˜ åƒæª”            â”‚
â”‚  2. åœæ­¢èˆŠçš„å®¹å™¨                           â”‚
â”‚  3. å•Ÿå‹•æ–°çš„å®¹å™¨                           â”‚
â”‚                                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  Docker Container            â”‚         â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚         â”‚
â”‚  â”‚  â”‚  Next.js App          â”‚  â”‚         â”‚
â”‚  â”‚  â”‚  (Port 3000)          â”‚  â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚              â†“                             â”‚
â”‚    é€£ç·šåˆ° AWS RDS                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                        â†“

ç¬¬äº”æ­¥ï¼šç”¨æˆ¶è¨ªå•
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚           ç”¨æˆ¶çš„ç€è¦½å™¨                      â”‚
â”‚                                            â”‚
â”‚  http://ä½ çš„EC2-IP:3000                    â”‚
â”‚              â†“                             â”‚
â”‚    çœ‹åˆ°ä½ çš„ Todo App                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ³ Docker æ˜¯ä»€éº¼ï¼Ÿ

### ç°¡å–®æ¯”å–»

æƒ³åƒ Docker æ˜¯ä¸€å€‹ã€Œé›†è£ç®±ã€ï¼š

- ä½ çš„æ‡‰ç”¨ç¨‹å¼å°±åƒè²¨ç‰©
- Docker å®¹å™¨å°±åƒæ¨™æº–åŒ–çš„é›†è£ç®±
- ä¸ç®¡åœ¨å“ªå€‹æ¸¯å£ï¼ˆä¼ºæœå™¨ï¼‰ï¼Œé›†è£ç®±éƒ½èƒ½æ­£å¸¸å·¥ä½œ

### Docker çš„ä¸‰å€‹æ ¸å¿ƒæ¦‚å¿µ

#### 1. **Dockerfile** (å»ºé€ è—åœ–)

å‘Šè¨´ Docker å¦‚ä½•ã€Œæ‰“åŒ…ã€ä½ çš„æ‡‰ç”¨ç¨‹å¼

```dockerfile
FROM node:24-alpine          # ä½¿ç”¨ Node.js ç’°å¢ƒ
COPY . .                     # è¤‡è£½ä½ çš„ä»£ç¢¼
RUN npm install              # å®‰è£ä¾è³´
RUN npm run build            # å»ºç½®æ‡‰ç”¨
CMD ["node", "server.js"]    # å•Ÿå‹•æ‡‰ç”¨
```

**å°±åƒé£Ÿè­œ**ï¼šå‘Šè¨´ä½ å¦‚ä½•ä¸€æ­¥æ­¥åšä¸€é“èœ

---

#### 2. **Docker Image (æ˜ åƒæª”)**

æ ¹æ“š Dockerfile å»ºç½®å‡ºä¾†çš„ã€Œæˆå“åŒ…ã€

```bash
your-username/todo-app:latest
```

**å°±åƒå®Œæˆçš„å†·å‡é¤**ï¼š

- åŒ…å«æ‰€æœ‰éœ€è¦çš„é£Ÿæï¼ˆä»£ç¢¼ã€ä¾è³´ï¼‰
- å¯ä»¥ä¿å­˜ï¼ˆå­˜åœ¨ Docker Hubï¼‰
- å¯ä»¥åˆ†äº«çµ¦åˆ¥äºº

**ç‰¹é»**ï¼š

- âœ… ä¸å¯è®Šçš„ï¼ˆå”¯è®€ï¼‰
- âœ… å¯ä»¥ç‰ˆæœ¬æ§åˆ¶
- âœ… å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹é‹è¡Œ

---

#### 3. **Docker Container (å®¹å™¨)**

å¾ Image å•Ÿå‹•çš„ã€Œé‹è¡Œå¯¦ä¾‹ã€

```bash
docker run your-username/todo-app:latest
```

**å°±åƒæ­£åœ¨åŠ ç†±çš„é¤é»**ï¼š

- å¯ä»¥é‹è¡Œï¼ˆåŸ·è¡Œä¸­çš„æ‡‰ç”¨ï¼‰
- å¯ä»¥åœæ­¢ã€é‡å•Ÿ
- å¯ä»¥åˆªé™¤

**ç‰¹é»**ï¼š

- âœ… è¼•é‡ç´šï¼ˆæ¯”è™›æ“¬æ©Ÿå°å¾ˆå¤šï¼‰
- âœ… éš”é›¢çš„ï¼ˆç¨ç«‹ç’°å¢ƒï¼‰
- âœ… å¯ä»¥å¤šå€‹åŒæ™‚é‹è¡Œ

---

### Docker çš„å„ªå‹¢

#### å‚³çµ±éƒ¨ç½²æ–¹å¼çš„å•é¡Œï¼š

```
é–‹ç™¼è€…é›»è…¦ âœ… å¯ä»¥é‹è¡Œ
åŒäº‹é›»è…¦   âŒ ç¼ºå°‘æŸå€‹ä¾è³´
æ¸¬è©¦ä¼ºæœå™¨ âŒ Node ç‰ˆæœ¬ä¸å°
æ­£å¼ä¼ºæœå™¨ âŒ ç’°å¢ƒè®Šæ•¸ä¸åŒ
```

#### ä½¿ç”¨ Dockerï¼š

```
é–‹ç™¼è€…é›»è…¦ âœ… Docker å®¹å™¨é‹è¡Œ
åŒäº‹é›»è…¦   âœ… Docker å®¹å™¨é‹è¡Œ
æ¸¬è©¦ä¼ºæœå™¨ âœ… Docker å®¹å™¨é‹è¡Œ
æ­£å¼ä¼ºæœå™¨ âœ… Docker å®¹å™¨é‹è¡Œ
```

**ã€Œåœ¨æˆ‘é›»è…¦å¯ä»¥é‹è¡Œã€â†’ Docker è®“å®ƒåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½é‹è¡Œï¼**

---

### Docker vs å‚³çµ±è™›æ“¬æ©Ÿ

```
å‚³çµ±è™›æ“¬æ©Ÿ (VM)                Docker å®¹å™¨
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   æ‡‰ç”¨ç¨‹å¼ A     â”‚           â”‚   æ‡‰ç”¨ç¨‹å¼ A     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚           â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
â”‚   ä¾è³´å¥—ä»¶       â”‚           â”‚   ä¾è³´å¥—ä»¶       â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   å®¢æˆ¶ä½œæ¥­ç³»çµ±   â”‚           â”‚   Docker Engine â”‚
â”‚   (Linux)       â”‚           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚   ä¸»æ©Ÿä½œæ¥­ç³»çµ±   â”‚
â”‚   Hypervisor    â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   ä¸»æ©Ÿä½œæ¥­ç³»çµ±   â”‚           âœ… æ›´è¼•é‡ (MB ç´šåˆ¥)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           âœ… å•Ÿå‹•æ›´å¿« (ç§’ç´š)
                              âœ… è³‡æºä½¿ç”¨å°‘
âŒ å¾ˆé‡ (GB ç´šåˆ¥)
âŒ å•Ÿå‹•æ…¢ (åˆ†é˜ç´š)
âŒ è³‡æºæ¶ˆè€—å¤§
```

---

## ğŸ¤– GitHub Actions æ˜¯ä»€éº¼ï¼Ÿ

### ç°¡å–®èªªæ˜

GitHub Actions æ˜¯ GitHub æä¾›çš„ã€Œè‡ªå‹•åŒ–æ©Ÿå™¨äººã€ï¼š

- ç•¶ä½ æ¨é€ä»£ç¢¼æ™‚è‡ªå‹•åŸ·è¡Œä»»å‹™
- ä¸éœ€è¦äººå·¥ä»‹å…¥
- åœ¨ GitHub çš„é›²ç«¯ä¼ºæœå™¨ä¸Šé‹è¡Œ

### å·¥ä½œæµç¨‹ (Workflow)

ä½ çš„ `.github/workflows/deploy.yml` æª”æ¡ˆå®šç¾©äº†è‡ªå‹•åŒ–æµç¨‹ï¼š

```yaml
on:
  push:
    branches:
      - main              # ç•¶æ¨é€åˆ° main åˆ†æ”¯æ™‚

jobs:
  build-and-deploy:       # åŸ·è¡Œä¸€å€‹å«åš build-and-deploy çš„ä»»å‹™
    runs-on: ubuntu-latest  # åœ¨ Ubuntu æ©Ÿå™¨ä¸Šé‹è¡Œ
    steps:                # åŸ·è¡Œä»¥ä¸‹æ­¥é©Ÿ
      - name: æ­¥é©Ÿ 1
      - name: æ­¥é©Ÿ 2
      ...
```

### æ¯”å–»

å°±åƒä¸€å€‹ã€Œè‡ªå‹•åŒ–å·¥å» æµæ°´ç·šã€ï¼š

```
åŸæ–™é€²å…¥ â†’ åŠ å·¥ â†’ åŒ…è£ â†’ é‹é€ â†’ ä¸Šæ¶
(ä»£ç¢¼)   (å»ºç½®) (æ‰“åŒ…) (æ¨é€) (éƒ¨ç½²)
```

**å…¨è‡ªå‹•ï¼Œç„¡éœ€äººå·¥å¹²é ï¼**

---

## ğŸ”„ å®Œæ•´éƒ¨ç½²æµç¨‹

### æ™‚é–“ç·šåˆ†è§£

```
T = 0 ç§’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½ åŸ·è¡Œï¼šgit push origin main          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 5 ç§’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub æ¥æ”¶åˆ°æ¨é€                     â”‚
â”‚ è§¸ç™¼ GitHub Actions                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 10 ç§’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Actions é–‹å§‹åŸ·è¡Œ               â”‚
â”‚ Step 1: Checkout code (ä¸‹è¼‰ä»£ç¢¼)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 20 ç§’
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 2-4: è¨­å®š Docker å’Œæ¨™ç±¤          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 30 ç§’ - 3 åˆ†é˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 5: å»ºç½® Docker Image            â”‚
â”‚ - å®‰è£ Node.js ä¾è³´                  â”‚
â”‚ - åŸ·è¡Œ Prisma generate              â”‚
â”‚ - å»ºç½® Next.js (standalone)          â”‚
â”‚ - æ¨é€åˆ° Docker Hub                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 3-4 åˆ†é˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Step 6: SSH é€£ç·šåˆ° EC2               â”‚
â”‚ - å‰µå»º .env æª”æ¡ˆ                     â”‚
â”‚ - ä¸‹è¼‰ docker-compose.yml           â”‚
â”‚ - æ‹‰å–æœ€æ–° image                     â”‚
â”‚ - åœæ­¢èˆŠå®¹å™¨                         â”‚
â”‚ - å•Ÿå‹•æ–°å®¹å™¨                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

T = 4-5 åˆ†é˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ éƒ¨ç½²å®Œæˆï¼                           â”‚
â”‚ ç”¨æˆ¶å¯ä»¥è¨ªå•æ–°ç‰ˆæœ¬                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•´å€‹éç¨‹é€šå¸¸éœ€è¦ 3-5 åˆ†é˜**

---

## ğŸ“ å„å€‹æª”æ¡ˆçš„ä½œç”¨

### 1. **Dockerfile**

```
ä½œç”¨ï¼šå®šç¾©å¦‚ä½•å»ºç½® Docker Image
ä½ç½®ï¼šå°ˆæ¡ˆæ ¹ç›®éŒ„
åŸ·è¡Œæ™‚æ©Ÿï¼šGitHub Actions å»ºç½®éšæ®µ
```

**å…§å®¹æ¦‚è¦**ï¼š

```dockerfile
# ç¬¬ä¸€éšæ®µï¼šå®‰è£ä¾è³´
FROM node:24-alpine AS deps
COPY package.json .
RUN npm ci

# ç¬¬äºŒéšæ®µï¼šå»ºç½®æ‡‰ç”¨
FROM node:24-alpine AS builder
COPY . .
RUN npm run build

# ç¬¬ä¸‰éšæ®µï¼šé‹è¡Œç’°å¢ƒ
FROM node:24-alpine AS runner
COPY --from=builder /app/.next/standalone ./
CMD ["node", "server.js"]
```

**ç‚ºä»€éº¼åˆ†éšæ®µï¼Ÿ**

- âœ… æœ€çµ‚ Image æ›´å°ï¼ˆåªåŒ…å«é‹è¡Œæ™‚éœ€è¦çš„æª”æ¡ˆï¼‰
- âœ… ä¸åŒ…å«é–‹ç™¼ä¾è³´ï¼ˆå®‰å…¨ï¼‰
- âœ… å»ºç½®å¿«å–æ›´é«˜æ•ˆ

---

### 2. **docker-compose.yml**

```
ä½œç”¨ï¼šå®šç¾©å¦‚ä½•é‹è¡Œå®¹å™¨
ä½ç½®ï¼šå°ˆæ¡ˆæ ¹ç›®éŒ„
åŸ·è¡Œæ™‚æ©Ÿï¼šåœ¨ EC2 ä¸Šéƒ¨ç½²æ™‚
```

**å…§å®¹èªªæ˜**ï¼š

```yaml
services:
  app: # æœå‹™åç¨±
    image: ${DOCKER_USERNAME}/todo-app:latest # ä½¿ç”¨çš„ image
    container_name: todo-app # å®¹å™¨åç¨±
    restart: unless-stopped # è‡ªå‹•é‡å•Ÿ
    ports:
      - "3000:3000" # ç«¯å£æ˜ å°„ï¼šä¸»æ©Ÿ:å®¹å™¨
    environment: # ç’°å¢ƒè®Šæ•¸
      - DATABASE_URL=${DATABASE_URL}
      - BETTER_AUTH_SECRET=${BETTER_AUTH_SECRET}
    healthcheck: # å¥åº·æª¢æŸ¥
      test: ["CMD", "wget", "--spider", "-q", "http://localhost:3000"]
      interval: 30s # æ¯ 30 ç§’æª¢æŸ¥ä¸€æ¬¡
```

**ç‚ºä»€éº¼éœ€è¦ï¼Ÿ**

- âœ… é…ç½®é›†ä¸­ç®¡ç†
- âœ… ç°¡åŒ–é‹è¡Œå‘½ä»¤ï¼ˆ`docker-compose up -d`ï¼‰
- âœ… ç’°å¢ƒè®Šæ•¸ç®¡ç†ï¼ˆä½¿ç”¨ .env æª”æ¡ˆï¼‰
- âœ… å¥åº·æª¢æŸ¥è‡ªå‹•ç›£æ§

---

### 3. **.github/workflows/deploy.yml**

```
ä½œç”¨ï¼šå®šç¾©è‡ªå‹•åŒ–éƒ¨ç½²æµç¨‹
ä½ç½®ï¼š.github/workflows/
åŸ·è¡Œæ™‚æ©Ÿï¼šgit push åˆ° main åˆ†æ”¯æ™‚
```

**7 å€‹æ­¥é©Ÿè©³è§£**ï¼š

#### **Step 1: Checkout code**

```yaml
- name: Checkout code
  uses: actions/checkout@v4
```

- **åšä»€éº¼**ï¼šä¸‹è¼‰ä½ çš„ GitHub ä»£ç¢¼
- **ç‚ºä»€éº¼**ï¼šGitHub Actions éœ€è¦ä»£ç¢¼æ‰èƒ½å»ºç½®
- **æ™‚é–“**ï¼š~5 ç§’

---

#### **Step 2: Set up Docker Buildx**

```yaml
- name: Set up Docker Buildx
  uses: docker/setup-buildx-action@v3
```

- **åšä»€éº¼**ï¼šå®‰è£ Docker å»ºç½®å·¥å…·
- **ç‚ºä»€éº¼**ï¼šå•Ÿç”¨å¿«å–ã€å¤šå¹³å°å»ºç½®
- **æ™‚é–“**ï¼š~5 ç§’

---

#### **Step 3: Log in to Docker Hub**

```yaml
- name: Log in to Docker Hub
  uses: docker/login-action@v3
  with:
    username: ${{ secrets.DOCKER_USERNAME }}
    password: ${{ secrets.DOCKER_PASSWORD }}
```

- **åšä»€éº¼**ï¼šç™»å…¥ Docker Hub
- **ç‚ºä»€éº¼**ï¼šéœ€è¦æ¬Šé™æ‰èƒ½æ¨é€ image
- **æ™‚é–“**ï¼š~3 ç§’

---

#### **Step 4: Extract Docker metadata**

```yaml
- name: Extract Docker metadata
  id: meta
  uses: docker/metadata-action@v5
```

- **åšä»€éº¼**ï¼šè‡ªå‹•ç”¢ç”Ÿ Docker æ¨™ç±¤
- **ç”¢ç”Ÿçš„æ¨™ç±¤**ï¼š
  - `main` - åˆ†æ”¯åç¨±
  - `main-abc1234` - åˆ†æ”¯ + Git commit SHA
  - `latest` - æœ€æ–°ç‰ˆæœ¬
- **ç‚ºä»€éº¼**ï¼šç‰ˆæœ¬è¿½è¹¤å’Œå›æ»¾
- **æ™‚é–“**ï¼š~2 ç§’

---

#### **Step 5: Build and push Docker image**

```yaml
- name: Build and push Docker image
  uses: docker/build-push-action@v5
  with:
    context: .
    file: ./Dockerfile
    push: true
    cache-from: type=gha
    cache-to: type=gha,mode=max
```

- **åšä»€éº¼**ï¼šå»ºç½® Docker Image ä¸¦æ¨é€åˆ° Docker Hub
- **éç¨‹**ï¼š
  1. è®€å– Dockerfile
  2. åŸ·è¡Œå¤šéšæ®µå»ºç½®
  3. ç”Ÿæˆ Prisma client
  4. å»ºç½® Next.js
  5. æ‰“åŒ…æˆ image
  6. æ¨é€åˆ° Docker Hub
- **ä½¿ç”¨å¿«å–**ï¼šç¬¬äºŒæ¬¡å»ºç½®æ›´å¿«ï¼ˆåªå»ºç½®è®Šæ›´çš„éƒ¨åˆ†ï¼‰
- **æ™‚é–“**ï¼šç¬¬ä¸€æ¬¡ 2-3 åˆ†é˜ï¼Œæœ‰å¿«å– 30-60 ç§’

**å»ºç½®éç¨‹è©³ç´°æ­¥é©Ÿ**ï¼š

```
1. FROM node:24-alpine AS deps
   â””â”€â–¶ å‰µå»ºåŸºç¤ç’°å¢ƒ

2. COPY package.json
   â””â”€â–¶ è¤‡è£½ä¾è³´æ¸…å–®

3. RUN npm ci
   â””â”€â–¶ å®‰è£ä¾è³´ï¼ˆä½¿ç”¨å¿«å–ï¼‰

4. COPY . .
   â””â”€â–¶ è¤‡è£½æ‰€æœ‰ä»£ç¢¼

5. RUN npm run build
   â””â”€â–¶ åŸ·è¡Œ prisma generate
   â””â”€â–¶ åŸ·ï¿½ï¿½ï¿½ next build

6. è¤‡è£½åˆ°æœ€çµ‚éšæ®µ
   â””â”€â–¶ åªä¿ç•™å¿…è¦æª”æ¡ˆ

7. æ¨é€åˆ° Docker Hub
   â””â”€â–¶ ä¸Šå‚³å®Œæ•´ image
```

---

#### **Step 6: Deploy to VPS**

```yaml
- name: Deploy to VPS
  uses: appleboy/ssh-action@v1.0.3
  with:
    host: ${{ secrets.EC2_HOST }}
    username: ${{ secrets.EC2_USERNAME }}
    key: ${{ secrets.EC2_SSH_KEY }}
    script: |
      # éƒ¨ç½²æŒ‡ä»¤
```

- **åšä»€éº¼**ï¼šSSH é€£ç·šåˆ° EC2 ä¸¦åŸ·è¡Œéƒ¨ç½²
- **éç¨‹**ï¼š

```bash
# 1. é€²å…¥æ‡‰ç”¨ç›®éŒ„
cd /home/ec2-user/todo-app

# 2. å‰µå»º .env æª”æ¡ˆ
cat > .env << EOF
DATABASE_URL=postgresql://...
BETTER_AUTH_SECRET=...
EOF

# 3. ä¸‹è¼‰ docker-compose.yml
curl -sSL https://raw.githubusercontent.com/.../docker-compose.yml -o docker-compose.yml

# 4. æ‹‰å–æœ€æ–° image
docker-compose pull
# å¾ Docker Hub ä¸‹è¼‰ your-username/todo-app:latest

# 5. åœæ­¢èˆŠå®¹å™¨
docker-compose down
# å„ªé›…åœ°åœæ­¢æ­£åœ¨é‹è¡Œçš„å®¹å™¨

# 6. å•Ÿå‹•æ–°å®¹å™¨
docker-compose up -d
# -d = detached mode (èƒŒæ™¯é‹è¡Œ)

# 7. ç­‰å¾…æœå‹™å¥åº·
sleep 15

# 8. é¡¯ç¤ºç‹€æ…‹å’Œæ—¥èªŒ
docker-compose ps
docker-compose logs --tail=50

# 9. æ¸…ç†èˆŠ images
docker image prune -af
```

**æ¯å€‹å‘½ä»¤çš„ä½œç”¨**ï¼š

**docker-compose pull**

```
åšä»€éº¼ï¼šå¾ Docker Hub ä¸‹è¼‰æœ€æ–° image
éç¨‹ï¼š
  1. é€£ç·šåˆ° Docker Hub
  2. æª¢æŸ¥æœ¬åœ° image ç‰ˆæœ¬
  3. ä¸‹è¼‰æ–°ç‰ˆæœ¬ (å¦‚æœæœ‰æ›´æ–°)
æ™‚é–“ï¼š30-60 ç§’ (å–æ±ºæ–¼ç¶²é€Ÿ)
```

**docker-compose down**

```
åšä»€éº¼ï¼šåœæ­¢ä¸¦ç§»é™¤å®¹å™¨
éç¨‹ï¼š
  1. ç™¼é€ SIGTERM è¨Šè™Ÿï¼ˆå„ªé›…åœæ­¢ï¼‰
  2. ç­‰å¾… 10 ç§’è®“æ‡‰ç”¨é—œé–‰
  3. å¦‚æœé‚„æ²’åœæ­¢ï¼Œå¼·åˆ¶çµ‚æ­¢ (SIGKILL)
  4. ç§»é™¤å®¹å™¨
ä¿ç•™ï¼š
  âœ… Volumes (è³‡æ–™ä¸æœƒä¸Ÿå¤±)
  âœ… Networks
  âœ… Images
æ™‚é–“ï¼š10-15 ç§’
```

**docker-compose up -d**

```
åšä»€éº¼ï¼šå•Ÿå‹•å®¹å™¨
éç¨‹ï¼š
  1. è®€å– docker-compose.yml
  2. è®€å– .env ç’°å¢ƒè®Šæ•¸
  3. å‰µå»ºå®¹å™¨
  4. å•Ÿå‹•å®¹å™¨
  5. åŸ·è¡Œå¥åº·æª¢æŸ¥
  6. èƒŒæ™¯é‹è¡Œ
æ™‚é–“ï¼š5-10 ç§’
```

- **æ™‚é–“**ï¼šæ•´å€‹éƒ¨ç½² 1-2 åˆ†é˜

---

#### **Step 7: Deployment notification**

```yaml
- name: Deployment notification
  if: success()
  run: |
    echo "âœ… Deployment successful!"
```

- **åšä»€éº¼**ï¼šé¡¯ç¤ºéƒ¨ç½²æˆåŠŸè¨Šæ¯
- **æ™‚é–“**ï¼š~1 ç§’

---

### 4. **.env.production.example**

```
ä½œç”¨ï¼šç’°å¢ƒè®Šæ•¸ç¯„ä¾‹
ä½ç½®ï¼šå°ˆæ¡ˆæ ¹ç›®éŒ„
ç”¨é€”ï¼šæ–‡æª”åƒè€ƒï¼ˆä¸æœƒè¢«ä½¿ç”¨ï¼‰
```

**å…§å®¹**ï¼š

```bash
DOCKER_USERNAME=your-dockerhub-username
DATABASE_URL=postgresql://...
BETTER_AUTH_SECRET=...
```

**å¯¦éš›ä½¿ç”¨çš„ .env**ï¼š

- åœ¨ EC2 ä¸Šï¼šGitHub Actions è‡ªå‹•å‰µå»º
- å¾ GitHub Secrets è®€å–å€¼

---

## ğŸ” GitHub Secrets çš„ä½œç”¨

### ç‚ºä»€éº¼éœ€è¦ Secretsï¼Ÿ

âŒ **éŒ¯èª¤åšæ³•**ï¼š

```yaml
# çµ•å°ä¸è¦é€™æ¨£å¯«ï¼
DATABASE_URL=postgresql://user:password123@rds.aws.com/db
```

- å¯†ç¢¼æœƒè¢«å…¬é–‹åœ¨ GitHub
- ä»»ä½•äººéƒ½èƒ½çœ‹åˆ°
- å®‰å…¨é¢¨éšªæ¥µé«˜

âœ… **æ­£ç¢ºåšæ³•**ï¼š

```yaml
DATABASE_URL=${{ secrets.DATABASE_URL }}
```

- å¯†ç¢¼åŠ å¯†å­˜å„²
- åªæœ‰ä½ èƒ½çœ‹åˆ°
- GitHub Actions åŸ·è¡Œæ™‚è§£å¯†

### Secrets å¦‚ä½•é‹ä½œ

```
1. ä½ åœ¨ GitHub è¨­å®š Secrets
   Settings â†’ Secrets â†’ New repository secret
   Name: DATABASE_URL
   Value: postgresql://...

2. GitHub åŠ å¯†å­˜å„²
   [åŠ å¯†] â†’ å­˜å…¥å®‰å…¨åº«

3. GitHub Actions åŸ·è¡Œæ™‚
   ${{ secrets.DATABASE_URL }}
   [è§£å¯†] â†’ ä½¿ç”¨çœŸå¯¦å€¼

4. æ—¥èªŒä¸­çš„ Secrets æœƒè¢«é®ç½©
   DATABASE_URL=***
```

---

## ğŸ¯ å¯¦éš›é‹ä½œç¯„ä¾‹

### å ´æ™¯ï¼šä½ ä¿®æ”¹äº†ä¸€å€‹ Bug

```
ç¬¬ 1 æ­¥ï¼šæœ¬åœ°é–‹ç™¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½ çš„é›»è…¦                         â”‚
â”‚                                 â”‚
â”‚ 1. ä¿®æ”¹ä»£ç¢¼: fix-bug.ts         â”‚
â”‚ 2. æ¸¬è©¦æœ¬åœ°é‹è¡Œ: npm run dev    â”‚
â”‚ 3. git add .                    â”‚
â”‚ 4. git commit -m "fix: bug"    â”‚
â”‚ 5. git push origin main         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        æ¨é€åˆ° GitHub
        â†“

ç¬¬ 2 æ­¥ï¼šGitHub æ¥æ”¶
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub                          â”‚
â”‚                                 â”‚
â”‚ âœ… æ¥æ”¶åˆ° commit                â”‚
â”‚ âœ… æª¢æ¸¬åˆ° main åˆ†æ”¯æœ‰è®Šæ›´        â”‚
â”‚ âœ… è§¸ç™¼ deploy.yml workflow     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        è§¸ç™¼ GitHub Actions
        â†“

ç¬¬ 3 æ­¥ï¼šè‡ªå‹•å»ºç½®
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GitHub Actions Runner           â”‚
â”‚ (GitHub çš„é›²ç«¯æ©Ÿå™¨)              â”‚
â”‚                                 â”‚
â”‚ [é–‹å§‹] 08:30:00                 â”‚
â”‚ â”œâ”€ Checkout code         5s     â”‚
â”‚ â”œâ”€ Setup Docker         5s     â”‚
â”‚ â”œâ”€ Login to Docker Hub  3s     â”‚
â”‚ â”œâ”€ Extract metadata     2s     â”‚
â”‚ â”œâ”€ Build Docker image   120s   â”‚
â”‚ â”‚  â”œâ”€ Install deps      30s    â”‚
â”‚ â”‚  â”œâ”€ Prisma generate   10s    â”‚
â”‚ â”‚  â”œâ”€ Next.js build     60s    â”‚
â”‚ â”‚  â””â”€ Push to Hub       20s    â”‚
â”‚ â””â”€ Deploy to EC2        90s    â”‚
â”‚    â”œâ”€ SSH connect       2s     â”‚
â”‚    â”œâ”€ Pull image        40s    â”‚
â”‚    â”œâ”€ Stop old          10s    â”‚
â”‚    â”œâ”€ Start new         10s    â”‚
â”‚    â”œâ”€ Health check      15s    â”‚
â”‚    â””â”€ Show logs         3s     â”‚
â”‚                                 â”‚
â”‚ [å®Œæˆ] 08:33:45 âœ…              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        éƒ¨ç½²åˆ° EC2
        â†“

ç¬¬ 4 æ­¥ï¼šEC2 é‹è¡Œæ–°ç‰ˆæœ¬
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä½ çš„ EC2 ä¼ºæœå™¨                  â”‚
â”‚                                 â”‚
â”‚ [èˆŠå®¹å™¨] todo-app               â”‚
â”‚ â”œâ”€ æ¥æ”¶åœæ­¢è¨Šè™Ÿ                 â”‚
â”‚ â”œâ”€ å®Œæˆç•¶å‰è«‹æ±‚                 â”‚
â”‚ â”œâ”€ é—œé–‰é€£ç·š                     â”‚
â”‚ â””â”€ [å·²åœæ­¢]                     â”‚
â”‚                                 â”‚
â”‚ [æ–°å®¹å™¨] todo-app               â”‚
â”‚ â”œâ”€ å¾ Docker Hub æ‹‰å–           â”‚
â”‚ â”œâ”€ è§£å£“ image                   â”‚
â”‚ â”œâ”€ å‰µå»ºå®¹å™¨                     â”‚
â”‚ â”œâ”€ è¼‰å…¥ç’°å¢ƒè®Šæ•¸                 â”‚
â”‚ â”œâ”€ é€£ç·š AWS RDS                 â”‚
â”‚ â”œâ”€ å•Ÿå‹• Next.js                 â”‚
â”‚ â””â”€ [é‹è¡Œä¸­] âœ…                  â”‚
â”‚                                 â”‚
â”‚ Port 3000 â†’ æ–°ç‰ˆæœ¬æ­£åœ¨æœå‹™       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â†“
        ç”¨æˆ¶å¯ä»¥è¨ªå•
        â†“

ç¬¬ 5 æ­¥ï¼šç”¨æˆ¶çœ‹åˆ°æ–°ç‰ˆæœ¬
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ç”¨æˆ¶ç€è¦½å™¨                       â”‚
â”‚                                 â”‚
â”‚ http://ä½ çš„EC2-IP:3000          â”‚
â”‚                                 â”‚
â”‚ âœ… Bug å·²ä¿®å¾©ï¼                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ•´å€‹éç¨‹åªéœ€ 3-5 åˆ†é˜ï¼Œå®Œå…¨è‡ªå‹•ï¼**

---

## ğŸ”„ æŒçºŒæ›´æ–°çš„å¥½è™•

### å‚³çµ±æ‰‹å‹•éƒ¨ç½²

```
1. ä¿®æ”¹ä»£ç¢¼          [ä½ ]     5åˆ†é˜
2. æ¸¬è©¦              [ä½ ]     10åˆ†é˜
3. SSH é€£ç·šåˆ°ä¼ºæœå™¨   [ä½ ]     1åˆ†é˜
4. æ‹‰å–ä»£ç¢¼          [ä½ ]     1åˆ†é˜
5. å®‰è£ä¾è³´          [ä½ ]     2åˆ†é˜
6. å»ºç½®              [ä½ ]     3åˆ†é˜
7. é‡å•Ÿæœå‹™          [ä½ ]     1åˆ†é˜
8. æª¢æŸ¥æ˜¯å¦æˆåŠŸ      [ä½ ]     2åˆ†é˜
9. å¦‚æœå¤±æ•—ï¼Œå›æ»¾    [ä½ ]     5åˆ†é˜

ç¸½è¨ˆï¼š30åˆ†é˜ + å®¹æ˜“å‡ºéŒ¯
```

### è‡ªå‹•åŒ–éƒ¨ç½²

```
1. ä¿®æ”¹ä»£ç¢¼          [ä½ ]     5åˆ†é˜
2. git push         [ä½ ]     10ç§’
3. å…¶é¤˜æ‰€æœ‰æ­¥é©Ÿ      [è‡ªå‹•]   3-5åˆ†é˜

ç¸½è¨ˆï¼š8-10åˆ†é˜ + å¯é ç©©å®š
```

**ç¯€çœæ™‚é–“ï¼š70%ï¼**
**äººç‚ºéŒ¯èª¤ï¼šé›¶ï¼**

---

## ğŸ› ï¸ æ•…éšœæ’é™¤

### å¦‚æœéƒ¨ç½²å¤±æ•—æ€éº¼è¾¦ï¼Ÿ

#### 1. æŸ¥çœ‹ GitHub Actions æ—¥èªŒ

```
1. å‰å¾€ GitHub â†’ Actions æ¨™ç±¤
2. é»æ“Šå¤±æ•—çš„ workflow
3. æŸ¥çœ‹å“ªä¸€æ­¥å¤±æ•—
4. å±•é–‹è©²æ­¥é©Ÿçœ‹è©³ç´°éŒ¯èª¤
```

#### 2. å¸¸è¦‹éŒ¯èª¤

**éŒ¯èª¤ï¼šDocker build failed**

```
åŸå› ï¼š
- ä»£ç¢¼æœ‰èªæ³•éŒ¯èª¤
- ä¾è³´å®‰è£å¤±æ•—
- Prisma schema æœ‰å•é¡Œ

è§£æ±ºï¼š
1. æœ¬åœ°æ¸¬è©¦ï¼šnpm run build
2. æª¢æŸ¥éŒ¯èª¤è¨Šæ¯
3. ä¿®å¾©å¾Œé‡æ–° push
```

**éŒ¯èª¤ï¼šSSH connection failed**

```
åŸå› ï¼š
- EC2 SSH key ä¸æ­£ç¢º
- EC2 å®‰å…¨çµ„æ²’æœ‰å…è¨± SSH
- EC2 IP æ”¹è®Šäº†

è§£æ±ºï¼š
1. é©—è­‰ EC2_SSH_KEY secret
2. æª¢æŸ¥å®‰å…¨çµ„è¦å‰‡
3. æ›´æ–° EC2_HOST secret
```

**éŒ¯èª¤ï¼šContainer won't start**

```
åŸå› ï¼š
- ç’°å¢ƒè®Šæ•¸ç¼ºå¤±æˆ–éŒ¯èª¤
- DATABASE_URL ç„¡æ³•é€£ç·š
- ç«¯å£å·²è¢«å ç”¨

è§£æ±ºï¼š
1. SSH åˆ° EC2
2. åŸ·è¡Œï¼šdocker-compose logs
3. æª¢æŸ¥éŒ¯èª¤è¨Šæ¯
4. é©—è­‰ç’°å¢ƒè®Šæ•¸
```

---

## ğŸ“Š ç›£æ§å’Œæ—¥èªŒ

### æŸ¥çœ‹å®¹å™¨ç‹€æ…‹

```bash
# æŸ¥çœ‹é‹è¡Œä¸­çš„å®¹å™¨
docker-compose ps

# è¼¸å‡ºç¯„ä¾‹ï¼š
NAME       IMAGE                    STATUS        PORTS
todo-app   username/todo-app:latest Up 2 hours    0.0.0.0:3000->3000/tcp
```

### æŸ¥çœ‹æ‡‰ç”¨æ—¥èªŒ

```bash
# å³æ™‚æŸ¥çœ‹æ—¥èªŒï¼ˆè·Ÿéš¨ï¼‰
docker-compose logs -f

# æŸ¥çœ‹æœ€è¿‘ 100 è¡Œ
docker-compose logs --tail=100

# åªçœ‹ç‰¹å®šæœå‹™
docker-compose logs app
```

### é€²å…¥å®¹å™¨å…§éƒ¨

```bash
# é€²å…¥å®¹å™¨çš„ shell
docker-compose exec app sh

# åœ¨å®¹å™¨å…§ï¼š
ls -la                    # æŸ¥çœ‹æª”æ¡ˆ
env                       # æŸ¥çœ‹ç’°å¢ƒè®Šæ•¸
ps aux                    # æŸ¥çœ‹é€²ç¨‹
exit                      # é›¢é–‹
```

---

## ğŸ“ é—œéµæ¦‚å¿µç¸½çµ

### Docker ä¸‰è¦ç´ 

```
Dockerfile  â†’  Image  â†’  Container
(è—åœ–)       (æˆå“)     (é‹è¡Œå¯¦ä¾‹)

é£Ÿè­œ  â†’  å†·å‡é¤  â†’  åŠ ç†±çš„é¤é»
```

### GitHub Actions æµç¨‹

```
Push â†’ Trigger â†’ Build â†’ Push â†’ Deploy
(æ¨é€) (è§¸ç™¼)   (å»ºç½®) (æ¨é€) (éƒ¨ç½²)
```

### è‡ªå‹•åŒ–çš„åƒ¹å€¼

```
ä¸€æ¬¡è¨­å®š â†’ æ°¸ä¹…è‡ªå‹•
ç¯€çœæ™‚é–“ + æ¸›å°‘éŒ¯èª¤ + å¿«é€Ÿè¿­ä»£
```

---

## ğŸš€ ä¸‹ä¸€æ­¥

ç¾åœ¨ä½ äº†è§£äº†æ•´å€‹ç³»çµ±å¦‚ä½•é‹ä½œï¼Œä½ å¯ä»¥ï¼š

1. **ä¿®æ”¹ä»£ç¢¼** â†’ `git push` â†’ è‡ªå‹•éƒ¨ç½²
2. **æ·»åŠ åŠŸèƒ½** â†’ æ¸¬è©¦ â†’ æ¨é€ â†’ ä¸Šç·š
3. **ä¿®å¾© Bug** â†’ æäº¤ â†’ å¹¾åˆ†é˜å¾Œç”Ÿæ•ˆ
4. **æ“´å±•æœå‹™** â†’ ä¿®æ”¹ docker-compose.yml â†’ æ·»åŠ  Redis/Nginx

**ä¸€åˆ‡éƒ½æ˜¯è‡ªå‹•çš„ï¼** ğŸ‰

---

## ğŸ“š å»¶ä¼¸é–±è®€

- [Docker å®˜æ–¹æ–‡æª”](https://docs.docker.com/)
- [GitHub Actions æ–‡æª”](https://docs.github.com/actions)
- [Docker Compose æ–‡æª”](https://docs.docker.com/compose/)
- [Next.js Standalone æ¨¡å¼](https://nextjs.org/docs/advanced-features/output-file-tracing)

---

**ç¾åœ¨ä½ å·²ç¶“å®Œå…¨ç†è§£æ•´å€‹ç³»çµ±äº†ï¼ğŸ“**
